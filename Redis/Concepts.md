# Redis基本概念

## 1. Redis简介

Redis是一个存取速度非常快的菲关系型数据库。它采用key-value的方式进行存储，可以进行`String`类型与`String`，`List`，`Set`，`Sorted Set`以及`Hash`的映射。而且与Memcached不同，Redis可以将数据持久化到硬盘中。因此Redis即可以作为辅助数据库也可以作为主数据库来使用。

Redis的五种数据如下图所示：

![](images/1.png)

同时，Redis实现了**主从复制**的特性，执行复制的服务器会连接上主服务器，接受主服务器发送的数据库初始副本。之后在主服务器执行**写**命令的时候，也会发送到所有的从服务器上去执行，实现数据的同步。

Redis的数据存储在内存中，因此随机访问的性能很强.

## 2. Redis命令简介

### 2.1 String命令

Redis的字符串类型可以表示三种类型的数值：

* 字节串
* 整数（范围与long integer相同）
* 浮点数（精度与double相同）

String相关命令如图所示：

![](images/2.png)

同时，对字符串还有自增和自减的操作。如下图所示

![](images/2-1.png)

如果用户对不存在的键进行了自加或自减操作，默认值为0的自加或自减。如果待自加或自减的字符串不能被解释为一个整数或浮点数，Redis会向用户返回一个错误。

Redis对于字符串还有一些字符串操作和位操作的命令，如下图所示：

![](images/2-2.png)

### 2.2 List相关命令

List相关的命令如图所示：

![](images/3.png)

在Range命令中，如果第二个参数是-1的话就代表是范围结束（也就是最后一个）索引（事实上，可以将索引看成一个环，整数就是正着数的位置，负数就是反方向数的索引值）。

同时还有一些阻塞式的列表弹出命令和将元素从一个列表移动到另一个列表的命令，这些命令如下图所示：

![](images/3-1.png)

### 2.3 Set相关命令

List和Set都可放置多个成员，但是List中可以放置多个相同的成员，而Set使用了哈希表保证了存储的每个成员都是不同的（结构类似于Java中的HashSet，因此也是无序的）。Set相关的命令如下图所示：

![](images/4.png)

但是Set真正强大的地方在于其支持的**集合运算**，它可以组合和关联多个集合。集合运算操作指令如下图所示：

![](images/4-1.png)

### 2.4 Hash相关命令

Hash可以看做是一个微缩版的Redis，其结构如下图所示：

![](images/5.png)

相关的指令如下图所示：

![](images/6-1.png)

一次操作多个键值对的操作如下图所示：

![](images/6.png)

一些高级特性：

![](images/6-2.png)



### 2.5 ZSet相关指令

有序集合和散列一样，都存储了一个键值对，有序集合的值是一个分值，是一个浮点数。有序集合可以根据键来访问元素，也可以根据分值的排列顺序来访问元素。使用指令如下图所示：

![](images/7-1.png)

同时，ZSet也提供了一些范围操作以及集合运算操作的指令，如下图所示：

![](images/8.png)

### 2.6 订阅和发布

订阅者(Listener)负责订阅频道(Channel)，发布者(Publisher)负责向频道发送二进制字符串消息，所有订阅此频道的订阅者都会受到这条消息。

与此相关的指令如下图所示：

![](images/11.png)

### 2.7 其他指令

#### 2.7.1 排序

![](images/12.png)

#### 2.7.2 基本的Redis事务

Redis的事务主要涉及到五个命令：`MULTI`,`EXEC`,`WATCH`,`UNWATCH`,`DISCARD`。

首先要执行`MULTI`指令，将我们想执行的多个指令放在这条指令后，Redis会把这些指令放在一个任务队列中，然后执行这些指令。

#### 2.7.3 键的过期命令

![](images/13.png)

## 3. 数据安全与性能保证

### 3.1 持久化

Redis的持久化已经写过了，在[这里](../Sundry/Redis.md)。
