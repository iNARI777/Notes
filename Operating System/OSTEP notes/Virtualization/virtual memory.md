# 虚拟内存

## 1. 虚拟内存的目标

最原始的操作系统就是一个库，用户对于内存的操作也是直接在物理内存上进行操作。

但是后来由于 **多道程序设计** (Multiprogramming) 的出现，为了提高硬件资源的利用率，比如在一个进程进行 IO 操作的时候，调度其它进程进行运行。很快，分时使用 CPU 的方法出现了，一种分时的方法就是每个进程分别运行一小段时间，并且可以使用全部的内存，一段时间后将所有内存信息保存到硬盘，然后将 CPU 控制权交给下一个程序。但是这种方法有着大量的磁盘 IO ，十分耗费时间，后来人们发明了多个程序的数据在内存中共同存在的方式。这个时候内存的隔离就成了一个重要的问题，因为我们不希望一个程序可以读甚至修改另一个程序的内存。

之后就出现了地址空间的概念。它将物理地址抽象成了虚拟地址提供给程序使用。

那么虚拟内存设计的目标都有什么呢？

* 透明：虚拟内存的实现要对程序不可见，为此，操作系统和硬件需要做许多相应的工作；
* 高效：体现在两个方面，时间上，不能让程序的运行速度变得过慢；空间上，不能用过多的内存空间来支持内存的虚拟化。这也使得操作系统需要硬件的支持，比如 TLB；
* 安全：需要将进程与进程隔离开
